<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Sudoku</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }

        table {
            border-collapse: collapse;
            margin: 20px auto;
        }

        td {
            border: 1px solid #999;
        }

        input {
            width: 45px;
            height: 45px;
            text-align: center;
            font-size: 20px;
            border: none;
        }

            input:focus {
                outline: none;
                background: #eef;
            }
        /* Líneas gruesas para bloques 3x3 */
        tr:nth-child(3n) td {
            border-bottom: 3px solid black;
        }

        td:nth-child(3n) {
            border-right: 3px solid black;
        }

        tr:first-child td {
            border-top: 3px solid black;
        }

        td:first-child {
            border-left: 3px solid black;
        }
        /* Casillas fijas */
        .fixed {
            background: #ddd;
            font-weight: bold;
        }
        /* Colores por número */
        .n1 {
            color: red;
        }

        .n2 {
            color: blue;
        }

        .n3 {
            color: green;
        }

        .n4 {
            color: purple;
        }

        .n5 {
            color: orange;
        }

        .n6 {
            color: brown;
        }

        .n7 {
            color: teal;
        }

        .n8 {
            color: magenta;
        }

        .n9 {
            color: black;
        }
    </style>
</head>

<body>
    <h1>Sudoku</h1>
    <button onclick="loadSudoku('easy')">Fácil</button>
    <button onclick="loadSudoku('hard')">Difícil</button>
    <button onclick="resolver()">Resolver</button>

    <table id="sudoku"></table>

    <script>
        let currentSolution = [];
        let currentPuzzle = [];

        // Verificar si un número es válido en una posición
        function isValid(board, row, col, num) {
            // Verificar fila
            for (let x = 0; x < 9; x++) {
                if (board[row][x] === num) return false;
            }
            // Verificar columna
            for (let x = 0; x < 9; x++) {
                if (board[x][col] === num) return false;
            }
            // Verificar bloque 3x3
            let startRow = row - row % 3;
            let startCol = col - col % 3;
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 3; j++) {
                    if (board[i + startRow][j + startCol] === num) return false;
                }
            }
            return true;
        }

        // Resolver sudoku con backtracking
        function solveSudoku(board) {
            for (let row = 0; row < 9; row++) {
                for (let col = 0; col < 9; col++) {
                    if (board[row][col] === 0) {
                        for (let num = 1; num <= 9; num++) {
                            if (isValid(board, row, col, num)) {
                                board[row][col] = num;
                                if (solveSudoku(board)) return true;
                                board[row][col] = 0;
                            }
                        }
                        return false;
                    }
                }
            }
            return true;
        }

        // Generar sudoku completo aleatorio
        function generateCompleteSudoku() {
            let board = Array(9).fill(0).map(() => Array(9).fill(0));
            
            // Llenar diagonal de bloques 3x3 (no se afectan entre sí)
            for (let block = 0; block < 9; block += 3) {
                let nums = [1, 2, 3, 4, 5, 6, 7, 8, 9];
                // Mezclar números
                for (let i = nums.length - 1; i > 0; i--) {
                    let j = Math.floor(Math.random() * (i + 1));
                    [nums[i], nums[j]] = [nums[j], nums[i]];
                }
                
                let idx = 0;
                for (let i = 0; i < 3; i++) {
                    for (let j = 0; j < 3; j++) {
                        board[block + i][block + j] = nums[idx++];
                    }
                }
            }
            
            // Resolver el resto del tablero
            solveSudoku(board);
            return board;
        }

        // Generar puzzle quitando números
        function generatePuzzle(level) {
            // Generar solución completa
            currentSolution = generateCompleteSudoku();
            
            // Copiar solución para crear puzzle
            currentPuzzle = currentSolution.map(row => [...row]);
            
            // Determinar cuántas celdas quitar
            let cellsToRemove = level === 'easy' ? 40 : 55; // Fácil: 40 vacías, Difícil: 55 vacías
            
            // Quitar números aleatoriamente
            let removed = 0;
            while (removed < cellsToRemove) {
                let row = Math.floor(Math.random() * 9);
                let col = Math.floor(Math.random() * 9);
                
                if (currentPuzzle[row][col] !== 0) {
                    currentPuzzle[row][col] = 0;
                    removed++;
                }
            }
            
            return currentPuzzle;
        }

        function loadSudoku(level) {
            const table = document.getElementById("sudoku");
            table.innerHTML = "";
            
            // Generar nuevo puzzle aleatorio
            const puzzle = generatePuzzle(level);
            
            puzzle.forEach(row => {
                const tr = document.createElement("tr");
                row.forEach(num => {
                    const td = document.createElement("td");
                    const input = document.createElement("input");
                    if (num !== 0) {
                        input.value = num;
                        input.disabled = true;
                        input.classList.add("fixed", "n" + num);
                    }
                    input.maxLength = 1;
                    input.oninput = () => {
                        if (input.value < 1 || input.value > 9) {
                            input.value = "";
                        }
                        input.className = "n" + input.value;
                    };
                    td.appendChild(input);
                    tr.appendChild(td);
                });
                table.appendChild(tr);
            });
        }

        function resolver() {
            if (currentSolution.length === 0) {
                alert("Primero carga un sudoku");
                return;
            }
            
            const inputs = document.querySelectorAll("input");
            let i = 0;
            for (let r = 0; r < 9; r++) {
                for (let c = 0; c < 9; c++) {
                    inputs[i].value = currentSolution[r][c];
                    inputs[i].className = "n" + currentSolution[r][c];
                    inputs[i].disabled = true;
                    i++;
                }
            }
        }
    </script>
</body>
</html>
